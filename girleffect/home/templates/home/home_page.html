{% extends "base.html" %}
{% load wagtailcore_tags wagtailimages_tags static %}

{% block content %}
    {# Hero section - section includes links #}
    {% include "includes/hero_video_section.html" %}
    
    {# Homepage Carousel #}
    {% if page.carousel_items.exists %}
    <div class="carousel carousel--home">
        <h4 class="carousel__home-title">{{ page.overview_title }}</h4>
        {% image page.overview_image fill-1600x800 as overview_image %}
        <img class="carousel__image carousel__image--main" src="{{ overview_image.url }}">

        {% for item in page.carousel_items.all %}
            {% image item.image fill-1600x800 as carousel_item_image %}
            <img data-image="{{ forloop.counter }}" class="carousel__image carousel__image--hidden" src="{{ carousel_item_image.url }}">
            <div data-panel="{{ forloop.counter }}" class="carousel__panel-mobile">
                <h4 class="carousel__panel-title">{{ item.title }}</h4>
                <div class="carousel__panel-content">
                    <p>{{ item.description }}</p>
                    <div class="arrow"></div>
                </div>
            </div>
            {% if item.link_page %}
                <a href="{{ item.link_page.url }}">{{ item.link_text|default:item.title }}</a>
            {% elif page.link_url %}
                <a href="{{ item.url }}">{{ item.link_text|default:item.title }}</a>
            {% endif %}
        {% endfor %}

        <div class="carousel__panels">
             {% for item in page.carousel_items.all %}
                <div data-panel="{{ forloop.counter }}" class="carousel__panel">
                    <svg class="carousel__icon">
                        <use xlink:href="#chevron"></use>
                    </svg>
                    <h4 class="carousel__panel-title">{{ item.title }}</h4>
                    <div class="carousel__panel-content">
                        <p>{{ item.description }}</p>
                        <div class="arrow"></div>
                    </div>
                </div>
             {% endfor %}
        </div>
    </div>
    <div class="carousel__nav-home">
        <div class="js-home-nav-prev">
            <svg>
                <use xlink:href="#arrow"></use>
            </svg>
        </div>
        <div class="js-home-nav-next carousel__nav-home-next">
            <svg>
                <use xlink:href="#arrow"></use>
            </svg>
        </div>
    </div>
    {% endif %}
        
    {# Streamfield options #}
    <section class="section section--body">
        {{ page.body }}
    </section>

    {% if page.articles.exists %}
    <div class="article-container wrapper wrapper--medium">
        {% for article in page.articles %}
            <a class="article-card" href="{% pageurl article %}">
                {% if article.listing_image %}
                    {% image article.listing_image fill-380x225 %}
                {% endif %}
                <div class="article-card__content">
                    <span class="article-card__date">{{ article.display_date }}</span>
                    {% if article.listing_title %}
                        <div>{{ article.listing_title }}</div>
                    {% else %}
                        <div>{{ article.title }}</div>
                    {% endif %}
                    {% if article.listing_summary %}
                        <p>{{ article.listing_summary }}</p>
                    {% endif %}
                    <div class="arrow"></div>
                </div>
            </a>
        {% endfor %}
    </div>
    {% endif %}

    {# Call to Action, link is likely external #}
    {% if page.call_to_action %}
        <section class="cta">
            {% include "includes/call_to_action.html" %}
        </section>
    {% endif %}

{% endblock %}
